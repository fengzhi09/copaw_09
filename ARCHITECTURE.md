# Copaw æ¶æ„æ–‡æ¡£

> ç‰ˆæœ¬ï¼šv1.1 | æ›´æ–°ï¼š2025-02-26

---

## ä¸€ã€æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ç”¨æˆ· (User)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Channels (5 ä¸ªæ¸ é“)                              â”‚
â”‚         é£ä¹¦ | é’‰é’‰ | QQ | Discord | ç”µæŠ¥                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Gateway (ç½‘å…³)                                â”‚
â”‚              æ¶ˆæ¯åˆ†å‘ + èº«ä»½è®¤è¯ + äº‹ä»¶è¿‡æ»¤                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ä¸˜è„‘ (Thalamus)                              â”‚
â”‚              æœ¬åœ°è¿è¡Œ Qwen3-0.6B-FP8                                â”‚
â”‚              æ„å›¾è¯†åˆ« + è·¯ç”± + è®°å¿†æ£€ç´¢                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    00 ç®¡ç†é«˜æ‰‹          â”‚   â”‚        ä¸“ä¸šèŒèƒ½ (01-04)            â”‚
â”‚  â€¢ åˆ›å»ºæ–° Agent         â”‚   â”‚  01 å­¦éœ¸   â”‚ 02 ç¼–ç¨‹é«˜æ‰‹           â”‚
â”‚  â€¢ åˆå§‹åŒ–æµç¨‹           â”‚   â”‚  03 åˆ›æ„é’å¹´â”‚ 04 ç»Ÿè®¡å­¦é•¿           â”‚
â”‚  â€¢ æ±‡æŠ¥çŠ¶æ€             â”‚   â”‚           (05-08 é¢„ç•™)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       å°è„‘ (Cerebellum)                             â”‚
â”‚              ä»»åŠ¡æ‰§è¡Œ + å·¥å…·è°ƒç”¨ + æµç¨‹æ§åˆ¶                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®åº“ (PostgreSQL)                           â”‚
â”‚         è®°å¿† | æ—¥å¿— | ç»Ÿè®¡ | é…ç½® | å¯¹è¯                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€æ ¸å¿ƒæ¨¡å—

### 2.1 å‰é¢å¶ (Prefrontal)

| å±æ€§ | å€¼ |
|------|-----|
| **åŠŸèƒ½** | æ·±åº¦æ€è€ƒã€æ¨ç†ã€è§„åˆ’ |
| **é»˜è®¤æ¨¡å‹** | GLM-5 (æ™ºè°±) |
| **fallback** | MiniMax-M2.5-highspeed |
| **éƒ¨ç½²** | API è°ƒç”¨ |
| **ä½œç”¨** | Agent çš„"å¤§è„‘"ï¼Œè´Ÿè´£å¤æ‚æ¨ç†å’Œå†³ç­– |

### 2.2 ä¸˜è„‘ (Thalamus)

| å±æ€§ | å€¼ |
|------|-----|
| **åŠŸèƒ½** | æ„å›¾è¯†åˆ«ã€æ¶ˆæ¯è·¯ç”±ã€è®°å¿†ç´¢å¼• |
| **æ¨¡å‹** | Qwen3-0.6B-FP8 |
| **éƒ¨ç½²** | æœ¬åœ° GPU |
| **ä½œç”¨** | è·¯ç”±å†³ç­– + è®°å¿†æ£€ç´¢ + æ„å›¾ç†è§£ |

### 2.3 å°è„‘ (Cerebellum)

| å±æ€§ | å€¼ |
|------|-----|
| **åŠŸèƒ½** | ä»»åŠ¡æ‰§è¡Œã€å·¥å…·è°ƒç”¨ã€æµç¨‹æ§åˆ¶ |
| **æŠ€æœ¯** | Python + MCP |
| **å·¥å…·** | æœç´¢ã€æ–‡ä»¶ã€æµè§ˆå™¨ç­‰ |

### 2.4 æ„Ÿå®˜ (Sensors)

| æ„Ÿå®˜ | æ¨¡å‹ | åŠŸèƒ½ |
|------|------|------|
| **print** | nano-banana-pro | æ–‡ç”Ÿå›¾ |
| **dispatch** | Qwen3-0.6B | æ„å›¾åˆ†å‘ |
| **recorder** | - | æ–‡ç”Ÿè§†é¢‘ï¼ˆæš‚ä¸è°ƒç”¨ï¼‰ |

---

## ä¸‰ã€Agent çŸ©é˜µ

### 3.1 Agent åˆ—è¡¨

| ç¼–å· | è§’è‰² | èŒè´£ | æ²Ÿé€šé£æ ¼ |
|------|------|------|----------|
| **00** | ğŸ  ç®¡ç†é«˜æ‰‹ | åˆ›å»º Agentã€åˆå§‹åŒ–ã€æ±‡æŠ¥çŠ¶æ€ | ä¸»åŠ¨æ±‡æŠ¥ã€ç¡®è®¤åæ‰§è¡Œ |
| **01** | ğŸ§  å­¦éœ¸ | å­¦æœ¯æœç´¢ã€è®ºæ–‡è°ƒç ” | ç†æ€§ä¸¥è°¨ã€è¯æ®å……åˆ† |
| **02** | ğŸ’» ç¼–ç¨‹é«˜æ‰‹ | ä»£ç å¼€å‘ã€å·¥å…·é“¾æ£€æŸ¥ | é€»è¾‘ç¼œå¯†ã€ç»“æ„åŒ– |
| **03** | ğŸ¨ åˆ›æ„é’å¹´ | æ–‡å­—åˆ›ä½œã€ç»˜ç”»æç¤ºè¯ | å‘æ•£æ€ç»´ã€ç§¯ææ‰§è¡Œ |
| **04** | ğŸ“Š ç»Ÿè®¡å­¦é•¿ | æ¯æ—¥å¤ç›˜ã€çŸ¥è¯†æ”¶è— | å–„äºå€¾å¬ã€å½’çº³æ•´ç† |

### 3.2 Agent ç›®å½•ç»“æ„

```
agents/
â”œâ”€â”€ agent_00_ç®¡ç†é«˜æ‰‹/
â”‚   â”œâ”€â”€ .meta.json          # å…ƒæ•°æ®
â”‚   â”œâ”€â”€ agent.md            # å·¥ä½œæµé…ç½®
â”‚   â”œâ”€â”€ soul.md            # é£æ ¼é…ç½®
â”‚   â”œâ”€â”€ memory/            # ç‹¬ç«‹è®°å¿†
â”‚   â”‚   â”œâ”€â”€ short_term/    # çŸ­æœŸè®°å¿†
â”‚   â”‚   â””â”€â”€ long_term/     # é•¿æœŸè®°å¿†
â”‚   â”œâ”€â”€ skills/            # æŠ€èƒ½é…ç½®
â”‚   â”‚   â”œâ”€â”€ general/       # é€šç”¨æŠ€èƒ½
â”‚   â”‚   â”œâ”€â”€ required/      # ä¸“ä¸šå¿…å¤‡
â”‚   â”‚   â””â”€â”€ optional/      # ä¸“ä¸šå¯é€‰
â”‚   â””â”€â”€ records/           # æ‰§è¡Œè®°å½•
â”œâ”€â”€ agent_01_å­¦éœ¸/
â”œâ”€â”€ agent_02_ç¼–ç¨‹é«˜æ‰‹/
â”œâ”€â”€ agent_03_åˆ›æ„é’å¹´/
â””â”€â”€ agent_04_ç»Ÿè®¡å­¦é•¿/
```

---

## å››ã€æ•°æ®æµ

### 4.1 æ¶ˆæ¯å¤„ç†æµç¨‹

```
ç”¨æˆ·æ¶ˆæ¯
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Gateway æ¥æ”¶                                                     â”‚
â”‚    â€¢ æ¸ é“é€‚é…                                                       â”‚
â”‚    â€¢ èº«ä»½è®¤è¯                                                       â”‚
â”‚    â€¢ äº‹ä»¶è¿‡æ»¤                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. ä¸˜è„‘å¤„ç†                                                        â”‚
â”‚    â€¢ æ„å›¾è¯†åˆ«                                                       â”‚
â”‚    â€¢ Agent è·¯ç”±                                                     â”‚
â”‚    â€¢ è®°å¿†æ£€ç´¢                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. å‰é¢å¶æ€è€ƒ                                                      â”‚
â”‚    â€¢ æ·±åº¦æ¨ç†                                                       â”‚
â”‚    â€¢ è§„åˆ’å†³ç­–                                                       â”‚
â”‚    â€¢ ç”Ÿæˆå›å¤                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. å°è„‘æ‰§è¡Œ                                                        â”‚
â”‚    â€¢ å·¥å…·è°ƒç”¨                                                       â”‚
â”‚    â€¢ ä»»åŠ¡æ‰§è¡Œ                                                       â”‚
â”‚    â€¢ è®°å½•æ—¥å¿—                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. è¿”å›å“åº”                                                        â”‚
â”‚    â€¢ æ ¼å¼åŒ–è¾“å‡º                                                     â”‚
â”‚    â€¢ æ¸ é“é€‚é…                                                       â”‚
â”‚    â€¢ å‘é€æ¶ˆæ¯                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 åä½œæµç¨‹

```
ç”¨æˆ·éœ€æ±‚
    â”‚
    â–¼
00 å·åˆ†æéœ€æ±‚ â†’ åé—®ç¡®è®¤ â†’ ç”¨æˆ·ç¡®è®¤ â†’ åˆ†é… Agent
    â”‚
    â–¼
    â”œâ”€â†’ 01 å­¦éœ¸ ï¼ˆè°ƒç ”ï¼‰
    â”œâ”€â†’ 02 ç¼–ç¨‹é«˜æ‰‹ ï¼ˆå®ç°ï¼‰
    â”œâ”€â†’ 03 åˆ›æ„é’å¹´ ï¼ˆåŒ…è£…ï¼‰
    â””â”€â†’ 04 ç»Ÿè®¡å­¦é•¿ ï¼ˆæ€»ç»“ï¼‰
    â”‚
    â–¼
00 å·æ±‡æ€»ç»“æœ â†’ æ±‡æŠ¥ç”¨æˆ·
```

---

## äº”ã€æ•°æ®åº“è®¾è®¡

### 5.1 ER å…³ç³»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    agents    â”‚â”€â”€â”€â”€<â”‚ short_term   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   _memory    â”‚
      â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                    â”‚
      â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ credit_logs  â”‚     â”‚ long_term    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   _memory    â”‚
      â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ cost_stats   â”‚     â”‚ trace_logs   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ conversations â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 è¡¨ç»“æ„

| è¡¨å | è¯´æ˜ | å…³é”®å­—æ®µ |
|------|------|----------|
| `agents` | Agent å…ƒæ•°æ® | id, name, role, status |
| `short_term_memory` | çŸ­æœŸè®°å¿† | agent_id, session_id, content |
| `long_term_memory` | é•¿æœŸè®°å¿† | agent_id, title, content, tags |
| `trace_logs` | æ‰§è¡Œè¿½è¸ª | trace_id, span_id, agent_id |
| `credit_logs` | Credit æ¶ˆè€— | agent_id, operation, tokens |
| `cost_stats` | æˆæœ¬ç»Ÿè®¡ | agent_id, model, usage, cost |
| `conversations` | å¯¹è¯å†å² | user_id, agent_id, messages |
| `configs` | ç³»ç»Ÿé…ç½® | key, value |

---

## å…­ã€Channels

### 6.1 æ”¯æŒçš„æ¸ é“

| æ¸ é“ | åè®® | è®¤è¯æ–¹å¼ | äº‹ä»¶è¿‡æ»¤ |
|------|------|----------|----------|
| é£ä¹¦ | WebSocket | App ID/Secret | âœ… |
| é’‰é’‰ | WebHook | URL + Secret | âœ… |
| QQ | OneBot | WebSocket | âœ… |
| Discord | Bot API | Bot Token | âœ… |
| ç”µæŠ¥ | Bot API | Bot Token | âœ… |

### 6.2 äº‹ä»¶è¿‡æ»¤

```python
class ChannelFilter:
    def should_process(self, event: dict) -> bool:
        # æ£€æŸ¥äº‹ä»¶ç±»å‹
        if event["type"] in self.ignore_events:
            return False
        # æ£€æŸ¥ç”¨æˆ·
        if event["user_id"] in self.ignore_users:
            return False
        # æ£€æŸ¥å…³é”®è¯
        if any(k in event["content"] for k in self.ignore_keywords):
            return False
        return True
```

---

## ä¸ƒã€å®‰å…¨ä¸æƒé™

### 7.1 è®¤è¯å±‚çº§

| å±‚çº§ | æœºåˆ¶ |
|------|------|
| Channel | API Key / Webhook ç­¾å / Bot Token |
| Gateway | ç”¨æˆ·ç™½åå• (allowFrom) |
| Agent | æ•æ„Ÿæ“ä½œç¡®è®¤ |

### 7.2 æƒé™æ§åˆ¶

```json
{
  "permissions": {
    "file_read": ["*"],
    "file_write": ["workspace/"],
    "browser_use": true,
    "network": true,
    "create_agent": true,
    "view_credit": true
  }
}
```

---

## å…«ã€æˆæœ¬è®¡ç®—

### 8.1 è®¡è´¹æ¨¡å‹

```python
COST_PER_MODEL = {
    "glm-5": {
        "input": 0.001,   # Â¥/1K tokens
        "output": 0.001
    },
    "nano-banana-pro": {
        "per_image": 0.05  # Â¥/å¼ 
    },
    "MiniMax-M2.5": {
        "input": 0.0005,
        "output": 0.0015
    }
}
```

### 8.2 æˆæœ¬æŠ¥è¡¨

```json
{
  "period": "2025-02",
  "total_cost": 173.50,
  "by_agent": {
    "00": 12.30,
    "01": 45.20,
    "02": 68.00,
    "03": 28.00,
    "04": 20.00
  },
  "by_model": {
    "glm-5": 128.50,
    "nano-banana-pro": 45.00
  }
}
```

---

## ä¹ã€é”™è¯¯å¤„ç†

### 9.1 é‡è¯•ç­–ç•¥

```python
ERROR_HANDLER = {
    "rate_limit": {
        "max_retries": 3,
        "backoff": "exponential",
        "fallback": "switch_model"
    },
    "timeout": {
        "max_retries": 2,
        "backoff": "linear",
        "fallback": "retry_later"
    },
    "api_error": {
        "max_retries": 1,
        "backoff": "none",
        "fallback": "fallback_model"
    }
}
```

### 9.2 é™çº§é“¾

```
glm-5 â†’ MiniMax-M2.5-highspeed â†’ glm-4
nano-banana-pro â†’ dall-e-3 â†’ stable-diffusion
```

---

## åã€éƒ¨ç½²æ¶æ„

### 10.1 ç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç”¨æˆ·ç½‘ç»œ                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      è´Ÿè½½å‡è¡¡ / Nginx                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Copaw Gateway + Agents                           â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                    â”‚   Web Admin UI   â”‚                            â”‚
â”‚                    â”‚   (00 / 04 å¯¹è¯)  â”‚                            â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                    â”‚  Gateway         â”‚                            â”‚
â”‚                    â”‚  Thalamus (GPU)  â”‚                            â”‚
â”‚                    â”‚  Cerebellum      â”‚                            â”‚
â”‚                    â”‚  Agents (00-04)  â”‚                            â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PostgreSQL (Docker)                              â”‚
â”‚                    localhost:5432                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2 Docker éƒ¨ç½²

```bash
# PostgreSQL
docker run -d --name copaw-db \
  -e POSTGRES_DB=copaw \
  -e POSTGRES_USER=copaw \
  -e POSTGRES_PASSWORD=your_password \
  -p 5432:5432 \
  -v /opt/ai_works/copaw/data:/var/lib/postgresql/data \
  postgres:16-alpine
```

---

## åä¸€ã€Web ç®¡ç†ç«¯

### 11.1 åŠŸèƒ½

| åŠŸèƒ½ | Agent | è¯´æ˜ |
|------|-------|------|
| ç³»ç»Ÿç®¡ç† | 00 | æŸ¥çœ‹/ä¿®æ”¹é…ç½®ã€ç®¡ç† Agent |
| ç»Ÿè®¡æŠ¥è¡¨ | 04 | æŸ¥çœ‹æˆæœ¬ã€è®°å¿†ã€å¯¼å‡ºæŠ¥å‘Š |
| å¯¹è¯äº¤äº’ | 00/04 | å¯¹è¯å¼æ“ä½œ |

### 11.2 å¯¹è¯ç¤ºä¾‹

```
ç”¨æˆ·: æŸ¥çœ‹æœ¬æœˆæˆæœ¬
â† 04: æœ¬æœˆæˆæœ¬æ˜ç»†ï¼š
    â€¢ GLM-5: Â¥128.50
    â€¢ nano-banana-pro: Â¥45.00
    â€¢ æ€»è®¡: Â¥173.50

ç”¨æˆ·: è°ƒæ•´ 02 å·æ—¥é™é¢
â† 00: ç¡®è®¤ä¿®æ”¹ï¼š
    Agent: 02 ç¼–ç¨‹é«˜æ‰‹
    æ—¥é™é¢: 50 â†’ 100
    ç¡®è®¤è¯·å›å¤"ç¡®è®¤"
```

---

## åäºŒã€å®šæ—¶ä»»åŠ¡

### 12.1 ä»»åŠ¡åˆ—è¡¨

| ä»»åŠ¡ | Cron | æ‰§è¡Œè€… | è¯´æ˜ |
|------|------|--------|------|
| daily_report | `0 18 * * *` | 04 | æ¯æ—¥ 18:00 æ—¥æŠ¥ |
| dinner_meeting | `0 21 * * */3` | 00 | æ¯ 3 å¤© 21:00 æ™šé¤ä¼š |
| health_check | `0 */6 * * *` | ç³»ç»Ÿ | æ¯ 6 å°æ—¶å¥åº·æ£€æŸ¥ |

---

*v1.1 | æœ€åæ›´æ–°ï¼š2025-02-26*
